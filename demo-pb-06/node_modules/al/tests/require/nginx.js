var pkg = require('../../lib/smartos').pkg,
    remoteFile = require('../../lib/smartos').remoteFile,
    bash = require('../../lib/smartos').bash;

module.exports.exec = function() {
  describe('should have build tools installed :', function() {
    // install deps
    require('./build-essential').exec();
  });

  describe('install nginx :', function() {
    it('should download nginx', function(done) {
      remoteFile('http://nginx.org/download/nginx-1.2.3.tar.gz', 'nginx-1.2.3.tar.gz', '/root', done);
    });
    it('should extract nginx', function(done) {
      bash({
        cwd : '/root',
        creates : '/root/nginx-1.2.3',
        cmd : ['tar -xzf nginx-1.2.3.tar.gz']
      }, done);
    });
    it('should install nginx', function(done) {
      bash({
        cwd : '/root/nginx-1.2.3',
        creates : '/usr/local/nginx/sbin/nginx',
        cmd : ['./configure', 'make', 'make install']
      }, done);
    });
  });
}
